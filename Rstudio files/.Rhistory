}else if (all(str_detect(data$Name[i], regex(c("Estremo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Estremo"
} else if (str_detect(data$Name[i], regex(c("sontuoso"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Sontuoso"
}else if (str_detect(data$Name[i], regex(c("onyx"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Onyx"
}else if (all(str_detect(data$Name[i], regex(c("ristretto", "decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Ristretto Decaf"
}else if (all(str_detect(data$Name[i], regex(c("ristretto", "voordeelpak"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Ristretto"
}else if (str_detect(data$Name[i], regex(c("ristretto"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Ristretto"
}else if (str_detect(data$Name[i], regex(c("profondo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Profondo"
}else if (str_detect(data$Name[i], regex(c("mbia"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Colombia"
}else if (str_detect(data$Name[i], regex(c("india"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct India"
}else if (all(str_detect(data$Name[i], regex(c("supremo", "voordeelpak"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Supremo"
}else if (str_detect(data$Name[i], regex(c("supremo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 10 Ct Supremo"
}else if (all(str_detect(data$Name[i], regex(c("bio", "7"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Bio, Intensity 7"
}else if (all(str_detect(data$Name[i], regex(c("bio", "9"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Bio, Intensity 9"
}else if (str_detect(data$Name[i], regex(c("guatemala"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Guatemala"
}else if (str_detect(data$Name[i], regex(c("or absulo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Or Absolu"
}else if (str_detect(data$Name[i], regex(c("ultimo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Ultimo"
}else if (all(str_detect(data$Name[i], regex(c("forza", "10x"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Forza 10-Pack"
}else if (str_detect(data$Name[i], regex(c("forza"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Forza"
}else if (str_detect(data$Name[i], regex(c("lungo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Lungo Elegante"
}else if (str_detect(data$Name[i], regex(c("absolu"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Or Absolu"
}else if (str_detect(data$Name[i], regex(c("papua"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Papua New Guinea"
}else if (str_detect(data$Name[i], regex(c("limited"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Limited Creations"
}else if (all(str_detect(data$Name[i], regex(c("decaf", "voordeelpak"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Decaf"
}else if (str_detect(data$Name[i], regex(c("decaf"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Decaf"
}else if (str_detect(data$Name[i], regex(c("splendente"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Splendente"
}else if (str_detect(data$Name[i], regex(c("xxl"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct XXL"
}else if (str_detect(data$Name[i], regex(c("mattinata"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Mattinata"
}else if (str_detect(data$Name[i], regex(c("indon"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 10 Ct Indonesia"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("L'Or Espresso 20 Ct"),ignore_case=T)))==TRUE){
if (str_detect(data$Name[i], regex(c("Estremo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Estremo"
}else if (str_detect(data$Name[i], regex(c("sontuoso"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Sontuoso"
}else if (str_detect(data$Name[i], regex(c("onyx"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Onyx"
}else if (all(str_detect(data$Name[i], regex(c("ristretto", "decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Ristretto Decaf"
}else if (all(str_detect(data$Name[i], regex(c("ristretto", "familiepak"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Ristretto"
}else if (str_detect(data$Name[i], regex(c("ristretto"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Ristretto"
}else if (str_detect(data$Name[i], regex(c("profondo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Profondo"
}else if (str_detect(data$Name[i], regex(c("mbia"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Colombia"
}else if (str_detect(data$Name[i], regex(c("india"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct India"
}else if (str_detect(data$Name[i], regex(c("supremo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 20 Ct Supremo"
}else if (all(str_detect(data$Name[i], regex(c("bio", "7"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Bio, Intensity 7"
}else if (all(str_detect(data$Name[i], regex(c("bio", "9"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Bio, Intensity 9"
}else if (str_detect(data$Name[i], regex(c("guatemala"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Guatemala"
}else if (str_detect(data$Name[i], regex(c("or absulo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Or Absolu"
}else if (str_detect(data$Name[i], regex(c("ultimo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Ultimo"
}else if (str_detect(data$Name[i], regex(c("forza"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Forza"
}else if (str_detect(data$Name[i], regex(c("lungo elegante"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Lungo Elegante"
}else if (str_detect(data$Name[i], regex(c("absolu"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Or Absolu"
}else if (str_detect(data$Name[i], regex(c("splendente"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Splendente"
}else if (str_detect(data$Name[i], regex(c("mattinata"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Mattinata"
}else if (str_detect(data$Name[i], regex(c("decaf"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 20 Ct Decaf"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if(all(str_detect(data$Subbrand[i], regex(c("L'Or Espresso 40 Ct"),ignore_case=T)))==TRUE){
if (str_detect(data$Name[i], regex(c("Estremo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Estremo"
} else if (str_detect(data$Name[i], regex(c("sontuoso"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Sontuoso"
}else if (str_detect(data$Name[i], regex(c("onyx"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Onyx"
}else if (all(str_detect(data$Name[i], regex(c("ristretto", "decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Ristretto Decaf"
}else if (str_detect(data$Name[i], regex(c("ristretto"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Ristretto"
}else if (str_detect(data$Name[i], regex(c("profondo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Profondo"
}else if (str_detect(data$Name[i], regex(c("mbia"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Colombia"
}else if (str_detect(data$Name[i], regex(c("india"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct India"
}else if (str_detect(data$Name[i], regex(c("supremo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 40 Ct Supremo"
}else if (all(str_detect(data$Name[i], regex(c("bio", "7"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Bio, Intensity 7"
}else if (all(str_detect(data$Name[i], regex(c("bio", "9"),ignore_case=T)))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Bio, Intensity 9"
}else if (str_detect(data$Name[i], regex(c("guatemala"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Guatemala"
}else if (str_detect(data$Name[i], regex(c("or absulo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Or Absolu"
}else if (str_detect(data$Name[i], regex(c("ultimo"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Ultimo"
}else if (str_detect(data$Name[i], regex(c("forza"),ignore_case=T))==TRUE) {
data$Productname[i] <- "L'Or Espresso 40 Ct Forza"
}else{
data$Productname[i]<- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("L'Or Espresso 500g"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("Onyx", "4"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Onyx 4-pack"
}else if (str_detect(data$Name[i], regex(c("Onyx"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Onyx"
}else if (all(str_detect(data$Name[i], regex(c("Forza", "4"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Forza 4-pack"
}else if (str_detect(data$Name[i], regex(c("Forza"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Forza"
}else if (all(str_detect(data$Name[i], regex(c("Fortissimo", "4"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Fortissimo 4-pack"
}else if (str_detect(data$Name[i], regex(c("Fortissimo"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Fortissimo"
}else if (str_detect(data$Name[i], regex(c("crema"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Crema Absolu"
}else if (str_detect(data$Name[i], regex(c("Brésil"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Brazil"
}else if (str_detect(data$Name[i], regex(c("Brazil"),ignore_case=T))==TRUE){
data$Productname[i] <- "L'Or Espresso 500g Brazil"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("L'Or 1kg"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("forza"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso Forza 1kg"
}else{
data$Productname[i] <- "L'Or Espresso Classic 1kg"
}
}else if(all(str_detect(data$Subbrand[i], regex(c("L'Or 250g"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("forza"),ignore_case=T)))==TRUE){
data$Productname[i] <- "L'Or Espresso Forza 250g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Brand_Transformed[i], regex(c("Illy"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Subbrand[i], regex(c("Illy Dark Roast"),ignore_case=T)))==TRUE){
if (str_detect(data$Volume[i], regex(c("8.8"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Dark Roast Coffee 8.8 Oz"
}else if (str_detect(data$Volume[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Dark Roast Coffee 8.8 Oz"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}}
else if (all(str_detect(data$Subbrand[i], regex(c("Illy Espresso Cups"),ignore_case=T)))==TRUE){
if (str_detect(data$Name[i], regex(c("intens"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Intenso 10 Ct"
}else if (str_detect(data$Volume[i], regex(c("100"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups 100 Ct"
}else if (str_detect(data$Name[i], regex(c("forte"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Forte 10 Ct"
}else if (all(str_detect(data$Name[i], regex(c("classi", "lungo", "10 x 10"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic Lungo 10 Ct 10-pack"
}else if (all(str_detect(data$Name[i], regex(c("classi", "lungo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic Lungo 10 Ct"
}else if (all(str_detect(data$Name[i], regex(c("classi", "10 x 10"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic 10 Ct 10-pack"
}else if (str_detect(data$Name[i], regex(c("classi"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic 10 Ct"
}else if (str_detect(data$Name[i], regex(c("clássi"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic 10 Ct"
}else if (str_detect(data$Name[i], regex(c("kcups"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic KCups 10 Ct"
}else if (str_detect(data$Name[i], regex(c("decaf"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso Cups Classic Decaf 10 Ct"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Illy Espresso 250g"),ignore_case=T)))==TRUE){
if (str_detect(data$Name[i], regex(c("entcof"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso 250g Decaf"
}else if (str_detect(data$Name[i], regex(c("decaf"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso 250g Decaf"
}else if (str_detect(data$Name[i], regex(c("bean"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso 250g Beans"
}else if (str_detect(data$Name[i], regex(c("ganze"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso 250g Beans"
}else if (str_detect(data$Volume[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Espresso 250g"
}else{
data$Productname[i] <- "Illy Espresso 250g"
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Illy Classico 250g"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Volume[i], regex(c("250"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Classico Coffee 250g"
}else if (str_detect(data$Volume[i], regex(c("8.8"),ignore_case=T))==TRUE){
data$Productname[i] <- "Illy Classico Coffee 250g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Illy Coffee Filter 250g"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("250"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Coffee Filter 250g"
}else {
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Illy Cups 21s"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Illy Espresso Capsules Decaf 21s"
}else{
data$Productname[i] <- "Illy Espresso Capsules 21s"
}
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Brand_Transformed[i], regex(c("Nespresso"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Subbrand[i], regex(c("Nespresso Original Volluto"),ignore_case=T)))==TRUE){
if (str_detect(data$Name[i], regex(c("10"),ignore_case=T))==TRUE){
data$Productname[i] <- "Nespresso Original Volluto 10 Ct"
}else if (str_detect(data$Name[i], regex(c("50"),ignore_case=T))==TRUE){
data$Productname[i] <- "Nespresso Original Volluto 10 Ct"
}else if (str_detect(data$Name[i], regex(c("50"),ignore_case=T))==TRUE){
data$Productname[i] <- "Nespresso Original Volluto 10 Ct"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Brand_Transformed[i], regex(c("Lavazza"), ignore_case=T)))==TRUE){
if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Qualita Oro"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("250", "3"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 3x250g"
}else if (str_detect(data$Name[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 250g"
}else if (str_detect(data$Volume[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 250g"
}else if (all(str_detect(data$Name[i], regex(c("6x"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 6x1000g"
}else if (str_detect(data$Name[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 1000g"
}else if (str_detect(data$Name[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 500g"
}else if (str_detect(data$Volume[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 500g"
}else if (str_detect(data$Name[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kilo"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Oro Coffee 1000g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Qualita Rossa"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("250", "3"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 3x250g"
}else if (str_detect(data$Name[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 250g"
}else if (str_detect(data$Volume[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 250g"
}else if (str_detect(data$Name[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 1000g"
}else if (str_detect(data$Name[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 500g"
}else if (str_detect(data$Volume[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 500g"
}else if (str_detect(data$Name[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kilo"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Qualita Rossa Coffee 1000g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Instant Coffee"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("95"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Instant Coffee 95g"
}else if (all(str_detect(data$Volume[i], regex(c("95"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Instant Coffee 95g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Espresso 250g"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("250", "3"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Espresso Coffee 3x250g"
}else if (all(str_detect(data$Volume[i], regex(c("X2"),ignore_case=F)))==TRUE){
data$Productname[i] <- "Lavazza Espresso 2x250g"
}else if (all(str_detect(data$Name[i], regex(c("250", "8"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 8x250g"
}else if (all(str_detect(data$Volume[i], regex(c("250"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Espresso Coffee 250g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Crema e Gusto"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("250", "8"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 8x250g"
}else if (all(str_detect(data$Volume[i], regex(c("2x250"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 2x250g"
}else if (all(str_detect(data$Volume[i], regex(c("250", "3"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 3x250g"
}else if (all(str_detect(data$Volume[i], regex(c("X2"),ignore_case=F)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 2x250g"
}else if (str_detect(data$Name[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 250g"
}else if (str_detect(data$Volume[i], regex(c("250"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 250g"
}else if (str_detect(data$Name[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("1000"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 1000g"
}else if (str_detect(data$Name[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 500g"
}else if (str_detect(data$Volume[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 500g"
}else if (str_detect(data$Name[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kg"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 1000g"
}else if (str_detect(data$Volume[i], regex(c("kilo"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Crema e Gusto Coffee 1000g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Crema e Aroma"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("4er"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Aroma Coffee 4x1kg"
}else if (all(str_detect(data$Volume[i], regex(c("kg"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Aroma Coffee 1kg"
}else if (all(str_detect(data$Volume[i], regex(c("1000"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Aroma Coffee 1kg"
}else if (all(str_detect(data$Volume[i], regex(c("kg"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Crema e Aroma Coffee 1kg"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Capsules 16Ct"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("intens"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Intenso 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("lungo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Lungo 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("cremo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Cremoso 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("passion"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Passionale 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("tierra"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Tierra 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("deliz"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Delizioso 16Ct"
}else if (all(str_detect(data$Name[i], regex(c("modo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules A Modo Mio 16Ct"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Capsules 10Ct"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Decaf 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("ricco"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Ricco 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("ricoo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Ricco 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("intens"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Intenso 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("armon"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Armonico 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("legger"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Lungo Leggero 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("decis"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Deciso 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("avvol"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Avvolgente 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("classic"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Classico 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("ristret"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Ristretto 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("lungo"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Lungo 10Ct"
}else if (all(str_detect(data$Name[i], regex(c("vigor"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Capsules Vigoroso 10Ct"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza 250g"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Coffee Decaf 250g"
}else if (all(str_detect(data$Name[i], regex(c("club"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Club Coffee 250g"
}else{
data$Productname[i] <- "Lavazza Coffee 250g"
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza 500g"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("decaf"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Coffee Decaf 500g"
}else if (all(str_detect(data$Name[i], regex(c("tierra"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Tierra Coffee 500g"
}else if (all(str_detect(data$Name[i], regex(c("italian"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Italian Classic Coffee 500g"
}else{
data$Productname[i] <- "Lavazza Coffee 500g"
}
}else if (all(str_detect(data$Subbrand[i], regex(c("Lavazza Barista"),ignore_case=T)))==TRUE){
if (all(str_detect(data$Name[i], regex(c("perfetto", "250"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Barista Perfetto 250g"
}else if (all(str_detect(data$Name[i], regex(c("perfetto", "1"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Barista Perfetto 1kg"
}else if (all(str_detect(data$Name[i], regex(c("intenso", "1"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Barista Intenso 1kg"
}else if (all(str_detect(data$Name[i], regex(c("gran", "1"),ignore_case=T)))==TRUE){
data$Productname[i] <- "Lavazza Barista Gran Crema 1kg"
}else if (all(str_detect(data$Name[i], regex(c("perfetto"),ignore_case=T))) & str_detect(data$Volume[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Barista Perfetto 500g"
}else if (all(str_detect(data$Name[i], regex(c("intenso"),ignore_case=T))) & str_detect(data$Volume[i], regex(c("500"),ignore_case=T))==TRUE){
data$Productname[i] <- "Lavazza Barista Intenso 500g"
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}else{
data$Productname[i] <- paste(data$Name[i], data$Volume[i])
}
}
data <- data %>% filter(Brand_Transformed == "Nescafe" | Brand_Transformed == "Starbucks" | Brand_Transformed == "Illy" | Brand_Transformed == "L'OR" | Brand_Transformed == "Cafe Royal" | Brand_Transformed == "Lavazza"
| Brand_Transformed == "Nespresso"
| Brand_Transformed == "Maxwell House"
| Brand_Transformed == "Peet's Coffee"
| Brand_Transformed == "Dunkin"
| Brand_Transformed == "Folgers Coffee"
| Brand_Transformed == "Green Mountain"
| Brand_Transformed == "Gevalia"
| Brand_Transformed == "New England"
| Brand_Transformed == "Caribou Coffee"
| Brand_Transformed == "Kirkland Signature"
| Brand_Transformed == "Caffe Gondoliere"
| Brand_Transformed == "Cameron's Coffee"
| Brand_Transformed == "Chameleon"
| Brand_Transformed == "Kauai Coffee"
| Brand_Transformed == "Senseo")
patterns <- c("MOKAFLOR",
"CLORISMEN",
"JACOBS",
"AUCHAN",
"Simon",
"Peet",
"CAFFEITALIA",
"Jacobs",
"Dallmayr",
"Kit",
"Vittoria",
"Woolworths",
"Chá",
"Espressione",
"Costa",
"Santa",
"Island")
data <- data[!grepl(paste(patterns,
collapse = "|"),
data$Productname),]
View(data)
data <- data %>%
filter(Price != "no price available" & Price != "No Price Available" & Price != "out of stock, no price avaiable")
data$Price_sub <- str_replace(data$Price, ",", ".")
data$Price_filter <- gsub("[^0-9.-]", "", data$Price_sub)
data$Price_filter <- gsub("-.*", "", data$Price_filter)
data$Price_numeric <- as.numeric(stringr::str_remove(data$Price_filter, "\\.$"))
data$Koers <- as.numeric(data$Koers)
data$Price_in_euro <- data$Price_numeric * data$Koers
for (i in seq(1, length(data$Retailer))){
if (data$Retailer[i] == "Carrefour Tunesie"){
data$Price_in_euro[i] <- data$Price_in_euro[i] / 1000
}
}
View(data)
write_xlsx(data, "../Full Data/transformed_data_08_09_price_in_euro.xlsx", col_names=TRUE)
